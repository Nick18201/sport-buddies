<div class="container-index margin-navbar">
  <section class="search-container">
    <div class="form-container">
      <%= form_tag events_path, method: :get do %>
        <div class="row">
          <div class="col-lg-12">
            <div class="row">
              <div class="form-input-index col-lg-2 col-md-3 col-sm-12 p-0">
                <%= select_tag :city,
                  options_for_select(Event::CITIES, params[:city]),
                  class: "form-control search-slt",
                  prompt: "Localisation"
                %>
              </div>
              <div class="form-input-index col-lg-2 col-md-3 col-sm-12 p-0">
                <%= date_field_tag :starts_at, params[:starts_at],
                  class: "form-control search-slt"
                %>
              </div>
              <div class="form-input-index col-lg-2 col-md-3 col-sm-12 p-0">
                <%= select_tag :sport,
                  options_for_select(Event::SPORTS, params[:sport]),
                  class: "form-control search-slt" ,
                  prompt: "Sport"
                %>
              </div>
              <div class="col-lg-2 col-md-3 col-sm-12 p-0">
                <%= submit_tag "Rechercher", class: "searchformbutton wrn-btn" %>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </section>
  <div class="container-cards-map">
    <div class="index-cards">
      <% @events.each do |event| %>
          <% card_function = image_path "card-#{event.sport}.jpg" %>
        <div class="index-card-category" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(<%= card_function %>)">
          <div class="index-card-info">
            <div class="index-card-info-left">
              <h4> <strong> <%= event.sport.capitalize %> </strong>: <%= event.expected_level %></h4>
              <p><%= event.starts_at.strftime("%d/%m Ã  %HH") %></p>
            </div>
            <% if event.expected_participants_count.present? %>
              <div class="index-card-info-player">
                <p><%= event.participations.count %>/<%= event.expected_participants_count %></p>
              </div>
            <% else %>
              <div class="index-card-info-player">
              </div>
            <% end %>
            </div>
          <div class="index-card-btn">
            <%= link_to "Go !", event_path(event), class: "index-btn" %>
          </div>
        </div>
      <% end %>
    </div>
    <div id="map"
         style="width: 100%; height: 67vh"
         data-markers="<%= @markers.to_json %>"
         data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>
</div>
