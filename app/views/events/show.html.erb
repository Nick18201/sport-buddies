  <!-- meta tag à modifier en temps voulu -->
  <% content_for :meta_title, "#{@event.name} is on #{DEFAULT_META["meta_product_name"]}" %>
  <%# <% content_for :meta_description, @event.description %>
  <%# <% content_for :meta_image, cl_image_path(@event.photo.path) %>
<!-- <body class="show-body-background">
 -->
<div class="main-show">
  <div class="card-show-infos">
    <%= link_to "Voir d'autres activités", events_path, class: "backlink-show"  %>
    <h1><%= @event.name %></h1>
    <div class="card-event-description">
      <div class="event-owner-infos">
        <div class="owner-avatar">
          <%= cl_image_tag @event.owner.avatar.key, widht:  100, height: 100, crop: :fill  %>
          <p>Organisé par <strong> <%= @event.owner.first_name.capitalize %> <%= @event.owner.last_name.capitalize %></strong></p>
        </div>
      <div class="event-owner-level-expected" >
        <% if  @event.expected_level == "débutant" %>
          <p> <%= @event.expected_level.capitalize %></p>
          <h3><i class="fas fa-medal gold-color"></i></h3>
        <% elsif @event.expected_level == "intermédiaire" %>
          <p> <%= @event.expected_level.capitalize %></p>
          <h3><i class="fas fa-medal gold-color"></i></h3>
          <h3><i class="fas fa-medal gold-color"></i></h3>
        <% elsif @event.expected_level == "confirmé" %>
          <p> <%= @event.expected_level.capitalize %></p>
          <h3><i class="fas fa-medal gold-color"></i></h3>
          <h3><i class="fas fa-medal gold-color"></i></h3>
          <h3><i class="fas fa-medal gold-color"></i></h3>
        <% end %>
      </div>
    </div>
    <div class="card-event-date">
      <h2><i class="far fa-calendar-alt"></i> <strong> <%= @event.starts_at.strftime(" %d/%m") %> </strong></h2>
      <h2 class="gray-separator">|</h2>
      <h2><i class="fas fa-stopwatch"></i> <%= @event.starts_at.strftime("%HH") %> </h2>
      <h2 class="gray-separator">|</h2>
      <%# <div class="buddy-list"> %>
      <% if @event.expected_participants_count.present? %>
        <div type="" class="buddy-list" data-toggle="modal" data-target="#exampleModalCenter">
          <h2><%= @event.participations.count %> / <%= @event.expected_participants_count %> <i class="fas fa-user-friends"></i></h2>
        </div>
      <% else %>
        <div type="" class="" data-toggle="modal" data-target="#exampleModalCenter">
          <h3> Aucune limite de buddies</h3>
        </div>
      <% end %>
      <%# </div> %>
        <% if @event.owner[:id] == current_user.id %>
          <h2 class="gray-separator">|</h2>
          <h2><%= link_to edit_event_path(@event) do %>
          <i class='far fa-edit'>Modifier</i>
          <% end %>
          </h2>
        <% end %>
    </div>
    <p><%= @event.description %></p>
    <div class="cta-show">
      <% if @already_suscribed %>
      <%= link_to "Déjà inscrit 👍", profile_path(current_user), class: "btn-show-buddies" %>
      <!-- Button trigger modal -->
      <button type="button" class="btn-show-buddies" data-toggle="modal" data-target="#exampleModal">
        J'invite mes buddies
      </button>
      <% elsif @event.expected_participants_count == @event.participations.count %>
        <%= link_to "évènement complet 💪", events_path, class: "btn-show-buddies" %>
      <% else %>
        <%= link_to "Je m'inscris", event_participations_path(@event), class: "btn-show-participate", method: :post %>
        <button type="button" class="btn-show-buddies" data-toggle="modal" data-target="#exampleModal">
        J'invite mes buddies
        </button>
      <% end %>
        </div>
      </div>
    <div class="event-show-chat">
      <h3>Conversations</h3>
      <div class="message_to_send">
        <% if @already_suscribed.include?(current_user.id) %>
          <div>
          <%= simple_form_for [ @event, @message ], remote: true do |f| %>
            <%= f.input_field :content, label: false, placeholder: "Tape ton message ici #{@user.first_name.capitalize}", class: "field-message-content" %>
          </div>
          <div>
            <%= f.submit "Envoyer", class: "btn-show-participate" %>
          </div>
        <% end %>
        <% else %>
          <p class="unsuscribed-field-message-content"> Tu dois être inscrit pour participer à la conversation </p>
        <% end %>
      </div>
        <% @messages.each do |message| %>
      <div class="event-message">
        <div class="messages-avatar">
          <%= cl_image_tag message.user.avatar.key, widht:  100, height: 100, crop: :fill  %>
        </div>
        <div class="message-content">
          <p class="message-user"><strong> <%= message.user.first_name.capitalize %> <%= message.user.last_name.capitalize %></strong> <small><%= message.created_at.strftime(" %d/%m à %HH%Mm") %></small></p>
          <p class="message-user-content"><%= message.content %></p>
        </div>
      </div>
        <% end %>
    </div>
  </div>
    <div class="map-show">
      <div id="map"
          style="width: 100%; height: 100vh;"
          data-markers="<%= @markers.to_json %>"
          data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Inviter mes buddies</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <%= form_tag event_invitations_path(@event), method: :post do %>
          <div class="modal-body">
            <% @friends_to_invite.each do |friend| %>
              <%= check_box_tag "friend_ids[]", friend.id, false, id: "friend_ids_#{friend.id}", class: "check-box" %>
              <%= label_tag "friend_ids_#{friend.id}" do  %>
                <div class="modal-avatar">
                  <%= cl_image_tag friend.avatar.key, width:  100, height: 100  %>
                </div>
                <div class="modal-firstname">
                  <p><%= friend.first_name.capitalize %></p>
                </div>
              <% end %>
            <% end %>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
            <button type="submit" class="btn-show-participate">Envoyer</button>
          </div>
        <% end %>
      </div>
    </div>
  </div>


<!-- Modal for listing participants -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Les buddies inscrits</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
          <div class="modal-body">
            <% @event.participations.each do |participation|%>
              <div class="card_container_friend">
              <%= link_to  user_path(participation.user) do %>
                <%= cl_image_tag participation.user.avatar.key,class:"card_friend", height: 150, width: 150, crop: :fill %>
                  <p class= "card_friend_name"> <%= participation.user.first_name.capitalize  %> </p>
              <% end %>
              </div>
            <% end %>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
        </div>
    </div>
  </div>
</div>

